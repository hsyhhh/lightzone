#ifndef __ARM64_LZSANITIZE_H__
#define __ARM64_LZSANITIZE_H__

// HVC
#define FIELD_HIGHEST_HVC				0b11010100000
#define FIELD_ID_HVC					0b00010
#define FIELD_ID_HVC_MASK				0b11111
// ERET
#define FIELD_HIGHEST_ERET 				0b11010110100
#define FIELD_ID_ERET					0b111110000001111100000
#define FIELD_ID_ERET_MASK				0b111111111111111111111
// SYS
#define FIELD_HIGHEST_SYS(L)			(0b11010101000 + (L))
// LOAD/STORE UNPRIVILEGED
#define LOAD_STORE_UNPRI_MASK			0b00111011001000000000110000000000
#define LOAD_STORE_UNPRI_ID				0b00111000000000000000100000000000

#define GATE_INST_0						0xb25187e1
#define GATE_INST_1						0xf2800001
#define GATE_MASKED_INST_2				0xd2800000
#define GATE_INST_3						0xd63f0020

int inspect(int len, unsigned int *ptr, unsigned long flags, unsigned long hva, lzproc_t *proc);

#endif